language: node_js
node_js:
  - 5.1.1
services:
  - mongodb
addons:
  apt:
    sources:
      - mongodb-3.0-precise
    packages:
      - mongodb-org-server
before_script:
  - sleep 15
  - cp config/config.development.js.tpl config/config.development.js
  - DEBUG=server ./node_modules/.bin/babel-node src/index.js &
  - sleep 30
script:
  - gulp angry-lint
  - SESSIONID=00000000-0000-4000-0000-000000000000 export SESSIONID
  - node_modules/vault-client/example.js -s 'http://127.0.0.1:3000' put
  - node_modules/vault-client/example.js -s 'http://127.0.0.1:3000' get
  - node_modules/vault-client/example.js -s 'http://127.0.0.1:3000' put -s $SESSIONID -t data
  - node_modules/vault-client/example.js -s 'http://127.0.0.1:3000' get -s $SESSIONID -t data
  - node_modules/vault-client/example.js -s 'http://127.0.0.1:3000' get -s '*'
  - node_modules/vault-client/example.js -s 'http://127.0.0.1:3000' rm  -s $SESSIONID -t data
  - node_modules/vault-client/example.js -s 'http://127.0.0.1:3000' get -s '*'
  - node_modules/vault-client/example.js -s 'http://127.0.0.1:3000' qr
  - node_modules/vault-client/example.js -s 'http://127.0.0.1:3000' rm
notifications:
  slack:
    secure: "Lz/Mi0ZXCHUzbZpjSAUaM3M5S4XHhkY2B1GXY8JKorvv/eHR+rq7VMa4TwVjjxAC2tip3LdxlfBu+fFNKXo8Z7ccOhmKfZwbd2AqW+iqvQ5lcqyYERegiFBOxqBs4sE9JJ77n+ryRqGVINxeXO4m+M7eBY0k67WHozAobZqWBR86P6LnhLmNeDLGUInfS4sNQQAtEDS7DfNss1rBOsuSm1XihQnZ0cCnVtWLlM0VuJjw1yfeUFr/wcK4FIO/9LfeNTbEFHDEEyoBYjcNGyCeWpkcx+0nT27tssuKnj0Hk/yiWQgVSRKEwRWyO4GmOLUr2rzD9HwPHxvI7LdtnU6RnCQJGerOIcMtRWkGXdDsb69kC5M5ssoZHDsUriRWfeGkSaLgw8UeCviR/+GmsOcQcGt2xcq7/HnTxsTQ+iJDWVSQdhxCgQwlFj5frytDyXaB4l931gneNvoP9Ho6TSMsbBpqcNb62JHb5KibryJSK3FlZd2X/haXU53dRreJenvizdcEZOcg6KzNTXFYWZ3PQzA8iSJsPiLWtYarZny+X55ouh/V73/lFakhVYFnow7tY62f2htssjn9NC1sCdu3IZZEn1vHC+l/Lx3l5t1eHtZ9PbPmhEWA587oV3lxmqyPlbwHspA6cXKKBuqmCbCYTicANAZGhEtFOfzxf8hMsjE="
branches:
  except:
  - stable
